(function(t){var a,e=t(".mapContainer"),n=t(".main"),o=t(".mapManage"),i=(t(window),500),s=80,c="/",l="/images/",r=(t(window).height(),t(window).width(),t("html,body"),t(".addInfos"),t(".banner"),t(".nav")),d=t(".mapItem"),p=t(".mapItem .accordeon"),u=(t("body"),t(".kots").outerHeight(),t(".mapItem .tab")),f=0,g=(t(".mapManage .search .content"),t("#zoom"),t(".researchBtn")),h=t(".ListingBtn"),m=t(".switchView"),v=t(".mapManage .research"),b=t(".mapManage .oneBuilding"),y=(t('input[type="submit"]'),t("form"),t("#form-city"),t("input[data-disabled]"),t(".overlay")),k=(t(".helper"),t(".closeTuto")),w=t(".notDisplayThisTuto"),x=t(".notDisplayAllTuto"),D=t(".popup"),S=t(".popup.lang"),L=t(".popup.connection"),I=(t(".popup.agence"),t(".closePopup")),j=t(".toSocialLogin"),C=t(".toEmailLogin"),T=t(".loginEmail"),P=t(".loginSocial"),z=t(".toPopup"),E=t(".errorsNotifications"),_=t(".errorsNotifications .tab"),B=(t(".errorsNotifications .list"),0),N=(t(".warning-tick"),t(".warning-tick-box"),t(".closeTickbox"),t("#query"),t(".kots #container"),t(".kot:last").offset(),t(".loadmore"),t(".pagination"),t(".pagination ul"),t(".agenceAjax"),t(".deleteImage"));t(function(){X(),p.drags({handle:".head"}),t(".typeLocation")&&Y(),_.on("click","a",V),t("html").on("click",J),E.on("click",function(t){t.stopPropagation()}),ea(),na(),u.on("click","a",q),z.on("click",R),t(document).keyup(function(t){27==t.keyCode&&Z(t)}),I.on("click",Z),y.on("click",function(t){ta(t)}),r.find(".connection").on("click","a",R),j.on("click",G),C.on("click",K),t(window).resize(function(){ea(t(window).height()),na(t(window).width())}),t(".goTo").on("click",function(a){a.preventDefault(),oa(t("#main"))}),g.on("click",W),h.on("click",Q),k.on("click",H),w.on("click",F),x.on("click",F),t("form").on("submit",function(){t(this).prop("disabled",!0),t(this).val(t(this).attr("data-disabled"))}),U(),N.on("click",function(a){a.preventDefault(),A(t(this))})});var $=function(){t("#sortable").sortable({create:function(){var a={};t("#sortable li").each(function(e,n){var o=t(n).find("a").attr("data-id");a[o]=t(n).index()+1}),t("form > [name='image_order']").val(JSON.stringify(a))}})},A=function(a){t.ajax({type:"get",async:!1,url:c+"ajax/deleteImage/"+a.attr("data-id")+"/"+a.attr("data-proprieteId")+"/"+a.attr("data-type"),dataType:"json",success:function(e){"success"===e&&a.parent().fadeOut("fast",function(){t(this).remove()})}})},M=function(t,a){var e=t.split(".");return e[0]+"-"+a+"."+e[1]},O=function(a,e,n){a&&e&&t.ajax({type:"get",url:c+"ajax/getBuildingPhoto/"+n+"/"+e,dataType:"json",success:function(o){console.log(o),o&&(0==t('#images[data-type="'+n+'"]').length&&t("#baseForm").after('<div id="images" data-type='+n+'><ul id="sortable" class="ui-sortable"></ul></div>'),t('#images[data-type="'+n+'"]').find("li").remove());for(var i in o)t('#images[data-type="'+n+'"] ul').append('<li><span class="handle icon icon-move6"></span><a href="" class="deleteImage icon icon-remove11" data-id='+o[i].id+" data-proprieteId="+o[i].building_id+" data-type="+o[i].type+" title="+oLang.form.delete_image+'><div class="image"><img class="thumbnail" src="'+l+"users/"+a+"/buildings/"+e+"/"+n+"/"+M(o[i].url,"small")+'"></div></a></li>'),t(".deleteImage").on("click",function(a){a.preventDefault(),A(t(this))});$()}})},U=function(){settingsUpload=t(".mulitplefileuploader").each(function(){var a=t(this).parent().attr("data-proprieteId"),e=t(this).parent().attr("data-type"),n=t(this);t(this).uploadFile({url:c+"ajax/uploadBuildingImage/"+e+"/"+a,method:"post",allowedTypes:"jpg,gif,bmp,png",fileName:"file",autoSubmit:!0,multiple:!0,showStatusAfterSuccess:!1,dragDropStr:"<span><b>"+oLang.upload.dragDrop+"</b></span>",abortStr:oLang.upload.giveup,cancelStr:oLang.upload.stop,doneStr:oLang.upload.ok,multiDragErrorStr:oLang.upload.multiDrag,extErrorStr:oLang.upload.ext_error,sizeErrorStr:oLang.upload.size_error,uploadErrorStr:oLang.upload.not_allow,onSubmit:function(a){t("<input>").attr({type:"text",name:"file[]",value:a}).appendTo("#myform")},onSuccess:function(){t("#myform").submit(),console.log(t(this)),O(n.parent().attr("data-userId"),n.parent().attr("data-proprieteId"),n.parent().attr("data-type"))},onError:function(){t("#status").html("<font color='green'>Something Wrong</font>")}})})},F=function(a){a.preventDefault(),t.ajax({url:"createCookie/"+t(this).attr("data-name")}),H(a,t(this).parent())},H=function(a,e){a.preventDefault(),"undefined"!=typeof e?e.parent().css("display","none"):t(this).parent().css("display","none")},Q=function(a){a.preventDefault();var e=t(this);v.css("display","none"),b.css("display","block"),m.find("a").removeClass("active"),e.addClass("active")},W=function(a){a.preventDefault();var e=t(this);b.css("display","none"),v.css("display","block"),m.find("a").removeClass("active"),e.addClass("active")},X=function(){t.ajax({type:"get",async:!1,url:"/getAllLang",dataType:"json",success:function(t){return oLang=t,console.log(t),!0}})},Y=function(){t(".typeLocation li").each(function(){$checkbox=t(this).find('input[type="checkbox"]'),$checkbox.css({visibility:"hidden",position:"absolute",left:"-99999999px"}),t(this).find("label").css({backgroundImage:"url(./img/"+$checkbox.attr("data-background")+")",backgroundPosition:"top",width:"100%",height:100,paddingTop:60,display:"block"})})},q=function(t){t.preventDefault(),0===f?(d.css({left:"-220px"}),f=1):(d.css({left:"12px"}),f=0)},J=function(t){t.stopPropagation(),1===B&&(E.css({right:"-250px"}),B=0)},V=function(t){t.preventDefault(),0===B?(E.css({right:"12px"}),B=1):(E.css({right:"-250px"}),B=0)},G=function(t){t.preventDefault(),T.slideUp(function(){P.slideDown()})},K=function(t){t.preventDefault(),P.slideUp(function(){T.slideDown()})},R=function(a){a.preventDefault(),a.stopPropagation();var e=t(this).attr("data-type");"lang"===e?(y.css("display","block"),S.css("display","block")):"connection"===e&&(y.css("display","block"),L.css("display","block"))},Z=function(t){t.preventDefault(),D.fadeOut("fast",function(){aa()})},ta=function(t){t.preventDefault(),D.fadeOut("fast",function(){aa()})},aa=function(){y.css("display","none")},ea=function(c){e&&(a=c?(c-t(".banner").height())/100*s:(t(window).height()-t(".banner").height())/100*s,e.css({height:a,width:t(window).width()-240,"min-height":i}),o.css({height:a,"min-height":i}),n.css({height:"auto","min-height":"100%"}))},na=function(){},oa=function(a){t("html,body").animate({scrollTop:a.offset().top},"slow")}}).call(this,jQuery),function(t){t.fn.drags=function(a){if($that=t(this),a=t.extend({handle:"",cursor:"move"},a),""===a.handle)var e=this;else var e=this.find(a.handle);return e.css("cursor",a.cursor).on("mousedown",function(e){if(e.stopPropagation(),""===a.handle)var n=t(this).addClass("draggable");else{console.log(t(this));var n=t(this).addClass("active-handle");$that.addClass("draggable")}var o=n.css("z-index"),i=n.outerHeight(),s=n.outerWidth(),c=n.offset().top+i-e.pageY,l=n.offset().left+s-e.pageX;n.css("z-index",1e3).parents().on("mousemove",function(a){t(".draggable").offset({top:a.pageY+c-i,left:a.pageX+l-s}).on("mouseup",function(){t(this).removeClass("draggable").css("z-index",o)})}),e.preventDefault()}).on("mouseup",function(){""===a.handle?t(this).removeClass("draggable"):t(this).removeClass("active-handle").parent().removeClass("draggable")})}}.call(this,jQuery);