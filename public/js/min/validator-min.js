(function(e){var s=e("form.rules"),r=e('form.rules input:not([data-validator="false"])'),a=e(".showPassword"),i="/",n,o=!1;e(function(){s.on("submit",l),r.keydown(t),r.keyup(t),r.focus(t)});var t=function(){"undefined"==typeof n&&(n=JSON.parse(e(this).parents("form.rules").attr("data-rules")));var s=e(this).attr("name"),r=e(this).val();s.indexOf("[")>-1&&(s=s.substring(s.lastIndexOf("[")+1,s.lastIndexOf("]")));var a=n[s],o=e(this);if(""!==r&&("password-ck"===s||"password_ck"===s)&&(r=e(this).val()+":"+o.parents("form").find('input[name="password"]').val()),""!==r)var t=i+"getOneValidation/"+s+"/"+a+"/"+r;else var t=i+"getOneValidation/"+s+"/"+a;console.log(t),e.ajax({url:t,dataType:"json",type:"post",success:function(r){if(e.isPlainObject(r)){var a=r,i="";o.find("input").removeClass("form-error").siblings("icon-required").removeClass("error").siblings(".clear").remove(),o.siblings(".messageError").remove(),e.each(a.field,function(e,s){o.addClass("form-error").siblings("icon-required").addClass("error")});for(var n in a.message)o.next(".icon-required").length<1?o.after('<span class="'+s+' messageError">'+a.message[n]+"<span>"):o.next(".icon-required").after('<div class="clear"></div><span class="'+s+' messageError">'+a.message[n]+"<span>")}else o.siblings(".messageError").remove(),o.removeClass("form-error").siblings("icon-required").addClass("error")}})},l=function(s){o||(s.preventDefault(),e(this).find('input[type="submit"]').attr("disabled","disabled"));var r=e(this),a=e(this).serialize(),n=r.attr("data-rules");e.ajax({url:i+"getValidation/"+n,dataType:"json",type:"post",data:a,success:function(s){if(e.isPlainObject(s)){o=!1;var a=s,i="";r.find("input").removeClass("form-error").siblings("icon-required").removeClass("error"),e.each(a.fields,function(e,s){r.find('[name="'+e+'"]').addClass("form-error").siblings("icon-required").addClass("error")});for(var n in a.messages)i=i+'<li class="error"> '+a.messages[n]+" </li>";d(r,i),r.find('input[type="submit"]').removeAttr("disabled")}else o=!0,r.submit()}})},d=function(e,s){e.find(".errors").remove(),e.prepend('<div class="errors"><ul>'+s+"</ul></div>")}}).call(this,jQuery);